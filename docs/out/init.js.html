<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: init.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: init.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/** @const */ var NUM_BALLS = 10;
/** @const */ var TIME_DILATION = 2000;
/** @const */ var CANVAS_WIDTH = 500;
/** @const */ var CANVAS_HEIGHT = 500;
/** @const */ var ALPHA_THRESHOLD = 0.5;
/** @const */ var SPIROGRAPH_RADIUS = 10;
/** @const */ var SCALE_FACTOR = 20;
/** @const */ var METABALL_INNER_RADIUS_MIN = 0;
/** @const */ var METABALL_INNER_RADIUS_MAX = 1;
/** @const */ var METABALL_OUTER_RADIUS_MIN = 2;
/** @const */ var METABALL_OUTER_RADIUS_MAX = 4;

/**
 * Generate a spirograph function.
 * @tutorial spirograph
 * @param {number} r Radius of the spirograph
 * @param {number} k (0 - 1) Ratio of inner circle to outer circle.
 * @param {number} l (0 - 1) Hole distance from center of inner circle.
 * @return {function(number): { x: number, y: number }} Spirograph function. Takes a
 * timestamp and returns a set of x and y coordinates representing the position of the
 * spirograph at this point in time.
 */
var spirograph = function (r, k, l) {
	return function (t) {
		return {
			x: r * ((1 - k) * Math.cos(t) + l * k * Math.cos((1 - k) / k * t)),
			y: r * ((1 - k) * Math.sin(t) + l * k * Math.sin((1 - k) / k * t))
		};
	};
};

// create an array of metaballs
var balls = (function () {
	var balls = [];
	var metaballInnerRadiusSize = METABALL_INNER_RADIUS_MAX - METABALL_INNER_RADIUS_MIN;
	var metaballOuterRadiusSize = METABALL_OUTER_RADIUS_MAX - METABALL_OUTER_RADIUS_MIN;
	
	var i, ball;
	for (i = 0; i &lt; NUM_BALLS; i++) {
		ball = new meta.MetaBall;
		ball.position = (function () {
			var fn = spirograph(SPIROGRAPH_RADIUS, Math.random(), Math.random());
			var speed = (Math.random() * 2 - 1) / TIME_DILATION;
			return function (time) {
				time *= speed;
				return fn(time);
			};
		})();
		ball.r1 = METABALL_INNER_RADIUS_MIN + Math.random() * metaballInnerRadiusSize;
		ball.r2 = METABALL_OUTER_RADIUS_MIN + Math.random() * metaballOuterRadiusSize;
		balls.push(ball);
	};
	
	return balls;
})();

var requestAnimationFrame =
	window.requestAnimationFrame ||
	window.mozRequestAnimationFrame ||
	window.webkitRequestAnimationFrame ||
	window.msRequestAnimationFrame;

var start = window.mozAnimationStartTime || Date.now() || (new Date).getTime();

var canvas = document.createElement('canvas');
canvas.width = CANVAS_WIDTH;
canvas.height = CANVAS_HEIGHT;
var ctx = canvas.getContext('2d');
ctx.translate(CANVAS_WIDTH / 2, CANVAS_HEIGHT / 2);
ctx.scale(SCALE_FACTOR, SCALE_FACTOR);

// main loop
(function (time) {
	ctx.clearRect(-CANVAS_WIDTH / 2, -CANVAS_HEIGHT / 2, CANVAS_WIDTH, CANVAS_HEIGHT);
	
	for (var i = 0; i &lt; NUM_BALLS; i++) {
		var ball = balls[i];
		ball.update(time);
		meta.drawMetaBall(ctx, ball);
	}

	var id = meta.threshold(ctx, ALPHA_THRESHOLD);
	ctx.putImageData(id, 0, 0);
	
	requestAnimationFrame(arguments.callee);
})(start);

document.addEventListener('DOMContentLoaded', function () {
	document.body.appendChild(canvas);
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="meta.MetaBall.html">MetaBall</a></li></ul><h3>Namespaces</h3><ul><li><a href="meta.html">meta</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-spirograph.html">spirograph</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ALPHA_THRESHOLD">ALPHA_THRESHOLD</a></li><li><a href="global.html#CANVAS_HEIGHT">CANVAS_HEIGHT</a></li><li><a href="global.html#CANVAS_WIDTH">CANVAS_WIDTH</a></li><li><a href="global.html#METABALL_INNER_RADIUS_MAX">METABALL_INNER_RADIUS_MAX</a></li><li><a href="global.html#METABALL_INNER_RADIUS_MIN">METABALL_INNER_RADIUS_MIN</a></li><li><a href="global.html#METABALL_OUTER_RADIUS_MAX">METABALL_OUTER_RADIUS_MAX</a></li><li><a href="global.html#METABALL_OUTER_RADIUS_MIN">METABALL_OUTER_RADIUS_MIN</a></li><li><a href="global.html#NUM_BALLS">NUM_BALLS</a></li><li><a href="global.html#SCALE_FACTOR">SCALE_FACTOR</a></li><li><a href="global.html#spirograph">spirograph</a></li><li><a href="global.html#SPIROGRAPH_RADIUS">SPIROGRAPH_RADIUS</a></li><li><a href="global.html#TIME_DILATION">TIME_DILATION</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Sat Aug 31 2013 13:39:30 GMT+1000 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
